<header class="site-header">
  <div class="header-container">
    <div class="brand">
      <a class="brand-link" href="{{ '/' | relative_url }}">
        {{ site.title | default: "Alex Nugraha Setia" }}
      </a>
    </div>

    <nav class="main-nav">
      <a href="{{ '/' | relative_url }}">{{ site.data.lang[site.lang].nav_home | default: "Home" }}</a>
      <a href="{{ '/projects.html' | relative_url }}">{{ site.data.lang[site.lang].nav_projects | default: "Projects" }}</a>
      <a href="{{ '/cv.html' | relative_url }}">{{ site.data.lang[site.lang].nav_cv | default: "CV" }}</a>
      <a href="{{ '/about.html' | relative_url }}">{{ site.data.lang[site.lang].nav_about | default: "About" }}</a>
    </nav>

    <div class="header-controls">
      <select id="lang-switch" aria-label="Language switch">
        <option value="id">ID</option>
        <option value="en">EN</option>
      </select>
      <button id="theme-toggle" aria-label="Toggle theme">ðŸŒ“</button>
    </div>
  </div>
</header>

<script>
// --- Language switch ---
const langSel = document.getElementById('lang-switch');
if (langSel) {
  const current = localStorage.getItem('site_lang') || '{{ site.default_lang }}';
  langSel.value = current;
  langSel.addEventListener('change', e => {
    localStorage.setItem('site_lang', e.target.value);
    document.cookie = 'site_lang=' + e.target.value + '; path=/';
    location.reload();
  });
}

// --- Theme toggle (fixed event bug) ---
const themeToggle = document.getElementById('theme-toggle');
if (themeToggle) {
  themeToggle.addEventListener('click', e => {
    e.preventDefault(); // ðŸš« stop from bubbling to nav
    e.stopPropagation();

    const html = document.documentElement;
    const isDark = html.classList.contains('theme-dark');
    html.classList.toggle('theme-dark', !isDark);
    html.classList.toggle('theme-light', isDark);
    localStorage.setItem('theme', isDark ? 'theme-light' : 'theme-dark');
  });

  // apply saved theme
  const saved = localStorage.getItem('theme');
  if (saved) {
    document.documentElement.classList.add(saved);
  } else {
    document.documentElement.classList.add('theme-light');
  }
}
</script>
